# Функция расчета таблицы 14 (Давоми ҷадвали 14) для месяца Июль

## Общая информация

Функция `calculateHydrologyTable()` автоматически рассчитывает данные таблицы 14 на основе данных таблицы 16. Однако для месяца **Июль** расчеты выполняются **только для первой строки** (секция 1-1МК ПК90+50 ПК60+20).

## Особенность для Июля

В коде функции явно указано:
```typescript
// Месяцы для расчета: Август, Сентябрь, Октябрь
// По скриншоту: для Июля в строках 2-7 все ячейки пустые (прочерки)
// Расчеты для строк 2-7 выполняются только для Августа, Сентября, Октября
const monthsToProcess: Array<'aug' | 'sep' | 'oct'> = ['aug', 'sep', 'oct'];
```

**Это означает:**
- ✅ Строка 1 рассчитывается для Июля
- ❌ Строки 2-7 остаются пустыми (прочерки) для Июля

## Расчет для строки 1 в Июле

### Источник данных

Для расчета строки 1 используются данные из **таблицы 16, строка "1-4К, АИО - 4"** (number: 5):

**Данные для Июля:**
- Декада I: `372.2` л/с
- Декада II: `350.5` л/с  
- Декада III: `344.1` л/с

### Формулы для строки 1

#### 1. Формула Qх (входящий расход)

```
Qх = Q(1-4К)
```

**Значение берется напрямую из таблицы 16:**
- Декада I: `Qх = 372.2` л/с
- Декада II: `Qх = 350.5` л/с
- Декада III: `Qх = 344.1` л/с

#### 2. Формула S (потери воды)

```
S = 10 × A × L × √(Qх / 1000)
```

**Где:**
- **A** = 2.08 (коэффициент фильтрации, среднее значение)
- **L** = 3.030 км (длина участка канала)
- **Qх** = значение из таблицы 16 (л/с)

**Расчет для каждой декады:**

**Декада I:**
```
S = 10 × 2.08 × 3.030 × √(372.2 / 1000)
S = 10 × 2.08 × 3.030 × √0.3722
S = 10 × 2.08 × 3.030 × 0.6101
S = 38.4 л/с
```

**Декада II:**
```
S = 10 × 2.08 × 3.030 × √(350.5 / 1000)
S = 10 × 2.08 × 3.030 × √0.3505
S = 10 × 2.08 × 3.030 × 0.5920
S = 37.3 л/с
```

**Декада III:**
```
S = 10 × 2.08 × 3.030 × √(344.1 / 1000)
S = 10 × 2.08 × 3.030 × √0.3441
S = 10 × 2.08 × 3.030 × 0.5866
S = 37.0 л/с
```

#### 3. Формула Qfx (исходящий расход)

```
Qfx = Qх + S
```

**Расчет для каждой декады:**

**Декада I:**
```
Qfx = 372.2 + 38.4 = 410.6 л/с
```

**Декада II:**
```
Qfx = 350.5 + 37.3 = 387.8 л/с
```

**Декада III:**
```
Qfx = 344.1 + 37.0 = 381.1 л/с
```

## Реализация в коде

### Функция расчета потерь

```typescript
export function calculateLoss(Qvx: number, L: number, A: number = averageA): number {
  if (!Qvx || !L || Qvx <= 0 || L <= 0) return 0;
  const qxSqrt = Math.sqrt(Qvx / 1000);
  return 10 * A * L * qxSqrt;
}
```

**Параметры:**
- `Qvx` - входящий расход (л/с)
- `L` - длина участка (км)
- `A` - коэффициент фильтрации (по умолчанию 2.08)

### Расчет для строки 1 в компоненте

В компоненте `OfficialData.tsx` для строки 1 используется отдельная логика, которая работает для всех месяцев, включая Июль:

```typescript
// Берем данные из таблицы 16, строка "1-4К, АИО - 4"
const sourceRow = table16Part2Data.find(row => row.number === 5);

// Для первой формулы берем данные из таблицы 16
const firstFormulaValues = displayMonths.flatMap(({ key }) => {
  const values = sourceRow.decades[key]; // jul: [372.2, 350.5, 344.1]
  // ...
});

// Рассчитываем S для второй формулы
const secondFormulaValues = firstFormulaValues.map((qx) => {
  if (!qx) return 0;
  return calculateS(qx, row1Length); // L = 3.030 км
});

// Рассчитываем Qfx для третьей формулы
const thirdFormulaValues = firstFormulaValues.map((qx, idx) => {
  const s = secondFormulaValues[idx];
  return qx + s;
});
```

## Итоговая таблица для строки 1 в Июле

| Декада | Qх (л/с) | S (л/с) | Qfx (л/с) |
|--------|----------|---------|-----------|
| I      | 372.2    | 38.4    | 410.6     |
| II     | 350.5    | 37.3    | 387.8     |
| III    | 344.1    | 37.0    | 381.1     |

## Почему строки 2-7 пустые для Июля?

Согласно спецификации системы:
- Расчеты для строк 2-7 выполняются только для месяцев: **Август, Сентябрь, Октябрь**
- Для Июля эти строки остаются пустыми (прочерки)
- Это связано с особенностями водопользования в период Июля

## Физический смысл формул

### Формула потерь S

Формула `S = 10 × A × L × √(Qх / 1000)` основана на методе **САНИИРИ** (Среднеазиатский научно-исследовательский институт ирригации) и учитывает:

- **Коэффициент A (2.08)** - характеризует фильтрационные свойства грунта канала
- **Длина L** - чем длиннее канал, тем больше потери
- **Квадратный корень от расхода** - нелинейная зависимость потерь от расхода

### Формула Qfx

Формула `Qfx = Qх + S` может показаться необычной (обычно потери вычитаются), но в данном контексте:
- `Qх` - это базовый расход из таблицы 16
- `S` - это расчетные потери, которые добавляются для учета в дальнейших расчетах
- `Qfx` - итоговый расход с учетом потерь для передачи на следующий участок

## Выводы

1. **Для Июля рассчитывается только строка 1** таблицы 14
2. **Используются данные из таблицы 16** (строка "1-4К, АИО - 4")
3. **Применяются стандартные формулы** расчета потерь воды
4. **Результаты автоматически вычисляются** при изменении исходных данных
5. **Строки 2-7 остаются пустыми** согласно спецификации системы

